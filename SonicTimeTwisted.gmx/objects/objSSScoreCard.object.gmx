<!--This Document is generated by GameMaker, if you edit it by hand then you do so at your own risk!-->
<object>
  <spriteName>&lt;undefined&gt;</spriteName>
  <solid>0</solid>
  <visible>-1</visible>
  <depth>-1023</depth>
  <persistent>0</persistent>
  <parentName>objScoreCard</parentName>
  <maskName>&lt;undefined&gt;</maskName>
  <events>
    <event eventtype="0" enumb="0">
      <action>
        <libid>1</libid>
        <id>604</id>
        <kind>0</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>0</useapplyto>
        <exetype>1</exetype>
        <functionname>action_inherited</functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
      </action>
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>
if objProgram.in_past {
    if(objProgram.special_past_current_level == 7)
    {
        line1 = string_replace(tr("_ss_scorecard_GOT_ALL"), "%c", name_tag);
        line2 = tr("_ss_scorecard_TIME_STONES");
    }
    else
    {
        line1 = string_replace(tr("_ss_scorecard_GOT_A"), "%c", name_tag);
        line2 = tr("_ss_scorecard_TIME_STONE");
    }
} else {
    if(objProgram.special_future_current_level == 7)
    {
        line1 = string_replace(tr("_ss_scorecard_GOT_ALL"), "%c", name_tag);
        line2 = tr("_ss_scorecard_CHAOS_EMERALDS");
    }
    else
    {
        line1 = string_replace(tr("_ss_scorecard_GOT_A"), "%c", name_tag);
        line2 = tr("_ss_scorecard_CHAOS_EMERALD");
    }
}
// recalculate offsets
title_ox1 = (objScreen.width * 0.5) - (string_width(line1) * 0.5);
title_ox2 = (objScreen.width * 0.5) - (string_width(line2) * 0.5);
title_offset1 = ceil((title_ox1 + string_width(line1)) * 0.0625) * 16;
title_offset2 = ceil((objScreen.width - title_ox2) * 0.0625) * 16;
perfect_bonus = objProgram.ss_perfect_bonus;
rings_bonus = objProgram.ss_rings_bonus;
time_bonus = objProgram.ss_time_bonus;
is_act_scorecard = false;
/* the speed of the countdown depends on the score tally mode
if the score tally mode is "random digits" or "variable speed",
which are basically the same outside of what's displayed,
then the "change" depends on the biggest bonus value from which
to count down. Else, its value is mostly fixed
objScreen.score_tally_mode : 0 - random digits, 1 - variable speed, 2 - constant speed
*/
max_change = 100;
if(objScreen.score_tally_mode &lt; 2)
{
   max_change = max(1, max(time_bonus, rings_bonus, perfect_bonus) div (215));
}
// copies of variables containing bonuses
// if the score tally is set to "random digits" mode, these variables, which
// will be drawn, contain different values, unrelated to the real ones
draw_time_bonus = time_bonus;
draw_rings_bonus = rings_bonus;
draw_perfect_bonus = perfect_bonus;
draw_total_bonus = total_bonus;
// and these contain numbers of digits to show for the "random digits" mode
digits_time_bonus = string_length(string(time_bonus));
digits_rings_bonus = string_length(string(rings_bonus));
var expected_total_bonus = time_bonus + rings_bonus;
if(perfect_bonus &gt; 0)
{
    expected_total_bonus += perfect_bonus;
    digits_perfect_bonus = string_length(string(abs(perfect_bonus)));
}
else
{
    digits_perfect_bonus = 0;
}
digits_total_bonus = string_length(string(expected_total_bonus));
// save initial offsets
default_title_offset1 = title_offset1;
default_title_offset2 = title_offset2;
default_score_offset1 = score_offset1;
default_score_offset2 = score_offset2;
default_score_offset3 = score_offset3;
default_score_offset4 = score_offset4;

// lowercase name tag
switch (objGameData.character_id[0])
{
case 2: name_tag_lc = tr("_charname_1_lc"); break;
case 3: name_tag_lc = tr("_charname_2_lc"); break;
default: name_tag_lc = tr("_charname_0_lc"); break;
}

var name_tag_altnoun = "";
switch (objGameData.character_id[0])
{
case 2: name_tag_altnoun = tr("_charname_1_altnoun"); break;
case 3: name_tag_altnoun = tr("_charname_2_altnoun"); break;
default: name_tag_altnoun = tr("_charname_0_altnoun"); break;
}

super_title_line1 = string_replace(tr("_ss_scorecard_CAN_NOW_BECOME"), "%c", name_tag);
super_title_line2 = string_replace(tr("_ss_scorecard_SUPER"), "%c", name_tag_altnoun);
super_title_line1_player_overlay = name_tag;
super_title_line2_player_overlay = string_replace(tr("_ss_scorecard_SUPER"), "%c", name_tag_altnoun);
if(objProgram.inputManager.is_touchscreen)
{
    ss_instructions1 = string_replace(tr("_ss_scorecard_JUMP_AND_HOLD_TOUCHSCREEN"), "%c", name_tag_lc);
}
else
{
    ss_instructions1 = string_replace(tr("_ss_scorecard_JUMP_AND_HOLD"), "%c", name_tag_lc);
}
ss_instructions2 = string_replace(tr("_ss_scorecard_TO_TURN_INTO"), "%c", name_tag_lc);
next_message = false;
score_ox1 = score_ox;
score_ox2 = score_ox;
/* If Sonic just got the seventh Chaos Emerald - show a message */
if(
    objGameData.character_id[0] == 1
    &amp;&amp; 
    (!objProgram.in_past)
    &amp;&amp; 
    (objProgram.special_future_current_level == 7)
    )
{
    next_message = true;
}

// do we have the %break format character?
if (string_count("%b", super_title_line2) &gt; 0) {
    // here we just get rid of the character entirely.
    super_title_line2 = string_replace(super_title_line2, "%b", "");
    var _bpos = string_pos("%b", super_title_line2_player_overlay) + string_length("%b");
    var _bend = string_length(super_title_line2_player_overlay) - (_bpos - 1);
    super_title_line2_player_overlay = string_copy(super_title_line2_player_overlay, _bpos, _bend);
    show_debug_message("Found %break format character.");
    show_debug_message("overlay=" + super_title_line2_player_overlay);
}

// italian and german shenanigans
name_offsetx = string_width(string_copy(line1, 1, string_pos(name_tag, line1) - 1));
sline1_offsetx = string_width(string_copy(super_title_line1, 1, string_pos(super_title_line1_player_overlay, super_title_line1) - 1));
sline2_offsetx = string_width(string_copy(super_title_line2, 1, string_pos(super_title_line2_player_overlay, super_title_line2) - 1));
//next_message = true;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="6">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>stop_all_music(false);
level_goback();
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>// reinit scroll values
title_offset1 = default_title_offset1;
title_offset2 = default_title_offset2;
score_offset1 = default_score_offset1;
score_offset2 = default_score_offset2;
score_offset3 = default_score_offset3;
score_offset4 = default_score_offset4;
// screen positions
draw_set_font(objResources.fontTitleSmallest);
title_ox1 = (objScreen.width * 0.5) - (string_width(super_title_line1) * 0.5);
title_ox2 = (objScreen.width * 0.5) - (string_width(super_title_line2) * 0.5);
draw_set_font(objResources.fontHud);
score_ox1 = (objScreen.width * 0.5) - (string_width(ss_instructions1) * 0.5);
score_ox2 = (objScreen.width * 0.5) - (string_width(ss_instructions2) * 0.5);
score_offset1 = score_ox1 + objScreen.width;//(ceil((objScreen.width - score_ox1) * 0.0625) * 16) + 48;
score_offset2 = score_ox2 + objScreen.width;//(ceil((objScreen.width - score_ox2) * 0.0625) * 16) + 48;
alarm[6] = 300;
state = 6;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="4">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>alarm[5] = 30;
state = 5;
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="2" enumb="3">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>if(next_message)
{
    // there's a message to display about turning into Super Sonic,
    // so we're not done here yet
    state = 5;
    alarm[4] = 30;
}
else
{
    stop_all_music(false);
    level_goback();
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="3" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>switch(state)
{
    case 5:
        // scroll away - scores
        title_offset1 -= 16;
        title_offset2 -= 16;
        // scroll away - message
        score_offset1 -= 16;
        score_offset2 -= 16;
        score_offset3 -= 16;
        score_offset4 -= 16;
        break;    
    case 6:
        // scroll away - scores
        if title_offset1 title_offset1 = max(title_offset1 - 16, 0);
        if title_offset2 title_offset2 = max(title_offset2 - 16, 0);
        if score_offset1 score_offset1 = max(score_offset1 - 16, 0);
        if score_offset2 score_offset2 = max(score_offset2 - 16, 0);
        break;    
    default:
        event_inherited();
        break;
}
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="7" enumb="5">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>stop_all_music(false);
</string>
          </argument>
        </arguments>
      </action>
    </event>
    <event eventtype="8" enumb="0">
      <action>
        <libid>1</libid>
        <id>603</id>
        <kind>7</kind>
        <userelative>0</userelative>
        <isquestion>0</isquestion>
        <useapplyto>-1</useapplyto>
        <exetype>2</exetype>
        <functionname></functionname>
        <codestring></codestring>
        <whoName>self</whoName>
        <relative>0</relative>
        <isnot>0</isnot>
        <arguments>
          <argument>
            <kind>1</kind>
            <string>/// Draw scorecard - unless there is a message for Super Sonic, delegate to parent
if(state &gt;= 6)
{
    var draw_x_offset, draw_y_offset_title, draw_y_offset_score;
    draw_x_offset = view_xview[view_current];
    draw_y_offset_title = view_yview[view_current];
    draw_y_offset_score = view_yview[view_current];
    if(!is_act_scorecard)
    {
        draw_y_offset_title -= 16;
        draw_y_offset_score += 16;
    }
    draw_set_font(objResources.fontHud);
    draw_set_valign(fa_top);
    draw_set_halign(fa_left);
    draw_text_color(round(draw_x_offset+score_ox1 + score_offset1), draw_y_offset_score + 112, ss_instructions1,c_white,c_white,c_yellow,c_yellow,1);
    draw_text_color(round(draw_x_offset+score_ox2 + score_offset2), draw_y_offset_score + 128, ss_instructions2,c_white,c_white,c_yellow,c_yellow,1);
    // text
    draw_set_font(objResources.fontTitleSmallest);
    draw_text_color(round(draw_x_offset+title_ox1 - title_offset1), draw_y_offset_title + 56, super_title_line1,c_white,c_white,c_gray,c_gray,1);
    draw_text_color(round(draw_x_offset+title_ox1 - title_offset1 + sline1_offsetx), draw_y_offset_title + 56, super_title_line1_player_overlay,c_white,c_white,title_color,title_color,1);
    draw_text_color(round(draw_x_offset+title_ox2 + title_offset2), draw_y_offset_title + 74, super_title_line2,c_white,c_white,c_gray,c_gray,1);
    draw_text_color(round(draw_x_offset+title_ox2 + title_offset2 + sline2_offsetx), draw_y_offset_title + 74, super_title_line2_player_overlay,c_white,c_white,title_color,title_color,1);
}
else
{
    event_inherited();
}
/*
draw_set_halign(fa_center);
draw_set_font(objResources.fontHud);
draw_text(view_wview[view_current]/2, view_hview[view_current] - 32, "State "+string(state));
draw_set_halign(fa_left);
*/
</string>
          </argument>
        </arguments>
      </action>
    </event>
  </events>
  <PhysicsObject>0</PhysicsObject>
  <PhysicsObjectSensor>0</PhysicsObjectSensor>
  <PhysicsObjectShape>0</PhysicsObjectShape>
  <PhysicsObjectDensity>0.5</PhysicsObjectDensity>
  <PhysicsObjectRestitution>0.100000001490116</PhysicsObjectRestitution>
  <PhysicsObjectGroup>0</PhysicsObjectGroup>
  <PhysicsObjectLinearDamping>0.100000001490116</PhysicsObjectLinearDamping>
  <PhysicsObjectAngularDamping>0.100000001490116</PhysicsObjectAngularDamping>
  <PhysicsObjectFriction>0.200000002980232</PhysicsObjectFriction>
  <PhysicsObjectAwake>-1</PhysicsObjectAwake>
  <PhysicsObjectKinematic>0</PhysicsObjectKinematic>
  <PhysicsShapePoints/>
</object>
